name: edge-fabric

topology:
  nodes:
    srl1:
      kind: srl
      image: ghcr.io/nokia/srlinux:25.3.2
      mgmt-ipv4: 172.20.20.11
      startup-config: configs/srl1/config.json

    srl2:
      kind: srl
      image: ghcr.io/nokia/srlinux:25.3.2
      mgmt-ipv4: 172.20.20.12
      startup-config: configs/srl2/config.json

    leaf1:
      kind: linux
      image: quay.io/frrouting/frr:10.3.1
      mgmt-ipv4: 172.20.20.21
      exec:
        - sysctl -w net.ipv4.ip_forward=1
      binds:
        - ./configs/leaf1/frr.conf:/etc/frr/frr.conf
        - ./configs/leaf1/daemons:/etc/frr/daemons
        - ./configs/leaf1/vtysh.conf:/etc/frr/vtysh.conf

    leaf2:
      kind: linux
      image: quay.io/frrouting/frr:10.3.1
      mgmt-ipv4: 172.20.20.22
      exec:
        - sysctl -w net.ipv4.ip_forward=1
      binds:
        - ./configs/leaf2/frr.conf:/etc/frr/frr.conf
        - ./configs/leaf2/daemons:/etc/frr/daemons
        - ./configs/leaf2/vtysh.conf:/etc/frr/vtysh.conf

  links:
    - endpoints: ["srl1:ethernet-1/1", "leaf1:eth1"]
    - endpoints: ["srl1:ethernet-1/2", "leaf2:eth1"]
    - endpoints: ["srl2:ethernet-1/1", "leaf1:eth2"]
    - endpoints: ["srl2:ethernet-1/2", "leaf2:eth2"]
